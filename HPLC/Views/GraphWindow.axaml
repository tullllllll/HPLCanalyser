<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="clr-namespace:HPLC.ViewModels"
             xmlns:views="clr-namespace:HPLC.Views"
             x:Class="HPLC.Views.GraphWindow"
             x:DataType="vm:MainViewModel">
        
    <TabControl>
        <!-- Graph Tab -->
        <TabItem Header="Graph">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="*" /> 
                    <RowDefinition Height="200" />
                </Grid.RowDefinitions>

                <!-- Fills all space except the 200px below -->
                <views:GraphUserControl DataContext="{Binding GraphViewModel}" Grid.Row="0" />

                <!-- Fixed-height DataGrid -->
                <DataGrid ItemsSource="{Binding GraphViewModel.Peaks}"
                          AutoGenerateColumns="False"
                          IsReadOnly="True"
                          GridLinesVisibility="All"
                          BorderBrush="Gray"
                          BorderThickness="1"
                          Grid.Row="1">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="Start Time" Binding="{Binding StartTime}" />
                        <DataGridTextColumn Header="Peak Time" Binding="{Binding PeakTime}" />
                        <DataGridTextColumn Header="End Time" Binding="{Binding EndTime}" />
                        <DataGridTextColumn Header="Peak Height" Binding="{Binding PeakHeight}" />
                        <DataGridTextColumn Header="Area" Binding="{Binding Area}" />
                        <DataGridTextColumn Header="Width at Half Height" Binding="{Binding WidthAtHalfHeight}" />
                    </DataGrid.Columns>
                </DataGrid>
            </Grid>
        </TabItem>
        <!-- Graph Peak Data -->
        <TabItem Header="Peak Data" Cursor="Hand">
            <DataGrid ItemsSource="{Binding GraphViewModel.Peaks}"
                      IsReadOnly="True"
                      CanUserReorderColumns="True"
                      CanUserResizeColumns="True"
                      GridLinesVisibility="All"
                      BorderThickness="1" BorderBrush="Gray">
                <DataGrid.Columns>
                    <DataGridTextColumn Header="Start Time" Binding="{Binding StartTime}" />
                    <DataGridTextColumn Header="Peak Time" Binding="{Binding PeakTime}" />
                    <DataGridTextColumn Header="End Time" Binding="{Binding EndTime}" />
                    <DataGridTextColumn Header="Peak Height" Binding="{Binding PeakHeight}" />
                    <DataGridTextColumn Header="Area" Binding="{Binding Area}" />
                    <DataGridTextColumn Header="Width at Half Height" Binding="{Binding WidthAtHalfHeight}" />
                </DataGrid.Columns>
            </DataGrid>
        </TabItem>
        
        <!-- Reference Line Data -->
        <TabItem Header="Reference Line" Cursor="Hand">
            <DataGrid ItemsSource="{Binding ReferenceDataSet.DataPoints}"
                      IsReadOnly="True"
                      CanUserReorderColumns="True"
                      CanUserResizeColumns="True"
                      GridLinesVisibility="All" 
                      BorderThickness="1" BorderBrush="Gray">
                <DataGrid.Columns>
                    <DataGridTextColumn Header="Time"  Binding="{Binding Time}"/>
                    <DataGridTextColumn Header="Value" Binding="{Binding Value, StringFormat=F2}" />
                </DataGrid.Columns>
            </DataGrid>
        </TabItem>
        
        <!-- Settings Tab -->
        <TabItem Header="Settings" Cursor="Hand">
            <StackPanel Orientation="Vertical">
                <!-- Data Set Settings -->
                <StackPanel Orientation="Horizontal">
                    <!-- Main data set -->
                    <Expander MinWidth="300" VerticalAlignment="Top" Margin="5,0">
                        <Expander.Header>
                            <TextBlock>
                                <Run Text="Main Dataset"/>
                                <Run Text="{Binding DataSet.Name}"/>
                            </TextBlock>
                        </Expander.Header>
                        <StackPanel Orientation="Vertical">
                            <Grid RowDefinitions="*,*,*" ColumnDefinitions="150,*">
                                <!-- Data Set Name -->
                                <TextBlock Grid.Row="0" Grid.Column="0" Text="Name:"/>
                                <TextBlock Grid.Row="0" Grid.Column="1" Text="{Binding DataSet.Name}"/>
                            
                                <!-- Data Point Count -->
                                <TextBlock Grid.Row="1" Grid.Column="0" Text="Data Points:"/>
                                <TextBlock Grid.Row="1" Grid.Column="1" Text="{Binding DataSet.DataPoints.Count}"/>
                                
                                <!-- Color Picker -->
                                <TextBlock Grid.Row="2" Grid.Column="0" Text="Line Color:" VerticalAlignment="Center"/>
                                <ColorPicker Grid.Row="2" Grid.Column="1" Tag="Main" ColorChanged="ColorView_OnColorChanged" HorizontalAlignment="Left" Color="Blue"/>
                            </Grid>
                            <Button Command="{Binding SelectFileCommand}"
                                    CommandParameter="main"
                                    Content="Select Main Dataset"
                                    FontSize="16"
                                    Background="Purple"
                                    Foreground="White"
                                    FontWeight="UltraLight"
                                    HorizontalAlignment="Center"
                                    Margin="0, 5,0,0"
                                    Cursor="Hand"/>
                            <Button Command="{Binding DeselectFileCommand}"
                                    CommandParameter="main"
                                    Content="Deselect Main Dataset"
                                    FontSize="16"
                                    Background="Red"
                                    Foreground="White"
                                    HorizontalAlignment="Center"
                                    Margin="0,5,0,0"
                                    Cursor="Hand"/>
                        </StackPanel>
                    </Expander>
                    
                    <!-- Reference data set -->
                    <Expander MinWidth="300" VerticalAlignment="Top" Margin="5,0">
                        <Expander.Header>
                            <TextBlock>
                                <Run Text="Reference Dataset"/>
                                <Run Text="{Binding ReferenceDataSet.Name}"/>
                            </TextBlock>
                        </Expander.Header>
                        <StackPanel Orientation="Vertical">
                            <Grid RowDefinitions="*,*,*" ColumnDefinitions="150,*">
                                <!-- Data Set Name -->
                                <TextBlock Grid.Row="0" Grid.Column="0" Text="Name:"/>
                                <TextBlock Grid.Row="0" Grid.Column="1" Text="{Binding ReferenceDataSet.Name}"/>
                            
                                <!-- Data Point Count -->
                                <TextBlock Grid.Row="1" Grid.Column="0" Text="Data Points:"/>
                                <TextBlock Grid.Row="1" Grid.Column="1" Text="{Binding ReferenceDataSet.DataPoints.Count}"/>
                                
                                <!-- Color Picker -->
                                <TextBlock Grid.Row="2" Grid.Column="0" Text="Line Color:" VerticalAlignment="Center"/>
                                <ColorPicker Grid.Row="2" Grid.Column="1" Tag="Reference" ColorChanged="ColorView_OnColorChanged" HorizontalAlignment="Left" Color="Red"/>
                            </Grid>
                            <Button Command="{Binding SelectFileCommand}"
                                    CommandParameter="reference"
                                    Content="Select Reference Dataset"
                                    FontSize="16"
                                    Background="Purple"
                                    Foreground="White"
                                    FontWeight="UltraLight"
                                    HorizontalAlignment="Center"
                                    Margin="0,5,0,0"
                                    Cursor="Hand"/>
                            <Button Command="{Binding DeselectFileCommand}"
                                    CommandParameter="reference"
                                    Content="Deselect Reference Dataset"
                                    FontSize="16"
                                    Background="Red"
                                    Foreground="White"
                                    HorizontalAlignment="Center"
                                    Margin="0,5,0,0"
                                    Cursor="Hand"/>
                        </StackPanel>
                    </Expander>
                </StackPanel>
            </StackPanel>
        </TabItem>
    </TabControl>
</UserControl>
